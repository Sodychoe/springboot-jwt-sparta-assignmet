# 사용자 인증 서비스

## 서비스 개요

JWT 기반 인증 메커니즘을 적용해 보안성을 확보한 인증 서비스를 개발합니다.

## 기능 요구 사항

### 회원 가입

- 사용자는 이름과 패스워드 닉네임을 제출하여 회원가입을 할 수 있습니다.
- 이미 가입된 사용자가 회원가입을 하면 실패해야 합니다.

### 로그인

- 사용자는 이름과 패스워드를 제출하여 로그인을 할 수 있습니다
- 로그인 정보가 잘못되면 로그인에 실패해야 합니다.

### 관리자 권한 부여

- 사용자에게 관리자 권한을 부여합니다.
- 관리자가 아니라면 요청에 실패해야 합니다.

### JWT 토큰을 이용한 Access Token 발급 및 검증

#### 토큰 발급

- 토큰은 비밀 키로 서명되어야 하며, 만료 시간을 설정해야 합니다. (예: 2시간)
-
    - 토큰 구조
        - **Header**: 알고리즘 및 토큰 유형 정보
        - **Payload**: 사용자 ID(sub), 역할(roles), 발급 시간(iat), 만료 시간(exp) 등의 정보
        - **Signature**: 헤더와 페이로드가 변조되지 않았음을 확인하는 서명

#### 토큰 검증

- 모든 보호된 API 요청에는 HTTP 요청 헤더에 토큰을 포함해야 합니다.
- 헤더 형식:`Authorization: Bearer [토큰]`
- 서버는 아래의 검증을 수행합니다.
    - 토큰 존재 여부 확인
    - 서명 검증 (서버의 비밀 키로 서명 확인)
    - 토큰 만료 여부 확인
    - 토큰에 포함된 권한 정보 추출
    - SecurityContext에 인증 정보 설정
    - 요청한 API에 접근 권한이 있는지 확인

#### 에러 처리

- 토큰이 유효하지 않거나 만료된 경우 정해진 스팩으로 에러 응답을 반환합니다 
- 참고 : [JWT 에러 처리 스팩](apidesign.md)
